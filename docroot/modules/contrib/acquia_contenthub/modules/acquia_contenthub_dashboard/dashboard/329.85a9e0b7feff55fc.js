"use strict";(self.webpackChunkdc_ch=self.webpackChunkdc_ch||[]).push([[329],{20329:(Vt,O,l)=>{l.r(O),l.d(O,{DcChConnectedSitesFeatureModule:()=>Pt});var r=l(10210),f=l(97722),P=l(45028),Q=l(37166),t=l(70074);let V=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[r.ez]}),n})();var d=l(54057),D=l(86670),p=l(18592),F=l(44287),J=l(75770),_=l(92129),N=l(29024),U=l(60773),u=l(10963),B=l(29466),I=l(63098),q=l(74868),g=l(44386);function Y(n,s){if(1&n&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.ch_version," ")}}function H(n,s){if(1&n&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.drupal_version," ")}}function E(n,s){if(1&n&&(t.TgZ(0,"td",19),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.last_synced,"medium")," ")}}function $(n,s){1&n&&(t.TgZ(0,"td",17),t._uU(1,"[NA]"),t.qZA())}function j(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td",5),t._uU(2),t.qZA(),t.YNc(3,Y,2,1,"td",6),t.YNc(4,H,2,1,"td",6),t.TgZ(5,"td",7)(6,"span",8),t._uU(7),t.ALo(8,"titlecase"),t.qZA()(),t.TgZ(9,"td",7),t._uU(10),t.qZA(),t.TgZ(11,"td",9)(12,"a",10),t._uU(13),t.qZA()(),t.YNc(14,E,3,4,"td",6),t.TgZ(15,"td",11)(16,"a",12),t._UZ(17,"span",13),t.qZA(),t.TgZ(18,"mat-menu",14,15)(20,"button",16),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.openCdfDetailsModal(a.client))}),t.TgZ(21,"span",17),t._uU(22,"[ViewClientDetails]"),t.qZA()()()(),t.YNc(23,$,2,0,"ng-template",null,18,t.W1O),t.qZA()}if(2&n){const e=s.$implicit,i=t.MAs(19),o=t.MAs(24),a=t.oxw();t.xp6(2),t.hij(" ",e.client_name," "),t.xp6(1),t.Q6J("ngIf",e.ch_version)("ngIfElse",o),t.xp6(1),t.Q6J("ngIf",e.drupal_version)("ngIfElse",o),t.xp6(2),t.Q6J("ngClass",a.getBadgeByWebhookStatus(e.current_state)),t.xp6(1),t.Oqu(t.lcZ(8,13,e.current_state)),t.xp6(3),t.hij(" ",e.valid_ssl," "),t.xp6(2),t.uIk("href",e.webhook_url,t.LSH),t.xp6(1),t.hij(" ",e.webhook_url," "),t.xp6(1),t.Q6J("ngIf",e.last_synced>0)("ngIfElse",o),t.xp6(2),t.Q6J("matMenuTriggerFor",i)}}function G(n,s){if(1&n&&t._UZ(0,"dxp-dc-ch-ui-cdf-details",20),2&n){const e=t.oxw();t.Q6J("entity",e.viewDetailsDialogData.entity)("error",e.viewDetailsDialogData.error)}}let W=(()=>{class n{constructor(){this.viewDetails=!1}trackBySiteId(e,i){return i.webhook_uuid}getBadgeByWebhookStatus(e){switch(e.toLowerCase()){case"healthy":return"bg-success";case"suppressed":return"bg-warning";case"unreachable":return"bg-danger";default:return"bg-light"}}openCdfDetailsModal(e){this.viewDetailsDialogData={entity:e},this.viewDetails=!0}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["dxp-dc-ch-connected-sites-table-view"]],inputs:{sitesList:"sitesList"},decls:6,vars:4,consts:[[1,"table-responsive","card","table-card-body","px-4"],[1,"table","table-bordered","table-layout-fixed",2,"word-wrap","break-word"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"isOpen","isOpenChange"],[3,"entity","error",4,"ngIf"],[1,"tables-source","w-15","text-truncate"],["class","w-15",4,"ngIf","ngIfElse"],[1,"w-10"],[1,"badge",3,"ngClass"],[1,"tables-url","w-20","text-truncate"],["target","_blank"],[1,"text-center","w-5"],[1,"dropdown-ellipses",3,"matMenuTriggerFor"],[1,"fe","fe-more-vertical","fe-sm"],[1,"content-view-menu"],["menu","matMenu"],["type","button",1,"btn","btn-white","font-weight-normal",3,"click"],["translate",""],["emptyStateContainer",""],[1,"w-15"],[3,"entity","error"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"table",1)(2,"tbody"),t.YNc(3,j,25,15,"tr",2),t.qZA()()(),t.TgZ(4,"dxp-dc-ch-ui-table-dialog",3),t.NdJ("isOpenChange",function(a){return i.viewDetails=a}),t.YNc(5,G,1,2,"dxp-dc-ch-ui-cdf-details",4),t.qZA()),2&e&&(t.xp6(3),t.Q6J("ngForOf",i.sitesList)("ngForTrackBy",i.trackBySiteId),t.xp6(1),t.Q6J("isOpen",i.viewDetails),t.xp6(1),t.Q6J("ngIf",i.viewDetails))},dependencies:[r.mk,r.sg,r.O5,p.Pi,I.k,q.m,g.VK,g.p6,r.rS,r.uU],styles:["[_nghost-%COMP%]{display:block;height:calc(100vh - 240px)}[_nghost-%COMP%]   .card[_ngcontent-%COMP%]{border-radius:0 0 10px 10px;border-top:0}  .content-view-menu{border-radius:6px!important;min-height:inherit!important}  .content-view-menu .mat-menu-content{padding:0!important}dxp-dc-ch-ui-table-dialog[_ngcontent-%COMP%]{height:100%}dxp-dc-ch-ui-table-dialog[_ngcontent-%COMP%]     .content{height:calc(100% - 90px)}.table-card-body[_ngcontent-%COMP%]{padding:0 1.125rem}tr[_ngcontent-%COMP%]:not(:last-child){border-bottom:.5px solid #e0e6eb}td[_ngcontent-%COMP%]:first-child, td[_ngcontent-%COMP%]:last-child{padding-left:0;padding-right:0}"],changeDetection:0}),n})();var k=l(74024);function K(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.last_synced,"medium"))}}function z(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.ch_version)}}function X(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.drupal_version)}}function R(n,s){1&n&&(t.TgZ(0,"span",11),t._uU(1,"[NA]"),t.qZA())}function tt(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"h4",5),t._uU(4),t.qZA(),t.TgZ(5,"a",6),t._UZ(6,"span",7),t.qZA(),t.TgZ(7,"mat-menu",8,9)(9,"button",10),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.openCdfDetailsModal(a.client))}),t.TgZ(10,"span",11),t._uU(11,"[ViewClientDetails]"),t.qZA()()()(),t.TgZ(12,"div",12)(13,"p",13)(14,"a",14),t._uU(15),t.qZA()(),t.TgZ(16,"span",15),t._uU(17),t.ALo(18,"titlecase"),t.qZA(),t.TgZ(19,"div",16)(20,"div",17)(21,"span"),t._uU(22,"Last Updated: "),t.qZA(),t.YNc(23,K,3,4,"span",18),t.qZA(),t.TgZ(24,"div",19),t._UZ(25,"img",20),t.YNc(26,z,2,1,"span",18),t._UZ(27,"img",21),t.YNc(28,X,2,1,"span",18),t.qZA(),t.YNc(29,R,2,0,"ng-template",null,22,t.W1O),t.qZA()()()()}if(2&n){const e=s.$implicit,i=s.index,o=t.MAs(8),a=t.MAs(30),c=t.oxw();t.Q6J("ngClass",c.calculateColumnClass(i)),t.xp6(4),t.hij(" ",e.client_name," "),t.xp6(1),t.Q6J("matMenuTriggerFor",o),t.xp6(9),t.Q6J("title",e.webhook_url),t.uIk("href",e.webhook_url,t.LSH),t.xp6(1),t.hij(" ",e.webhook_url," "),t.xp6(1),t.Q6J("ngClass",c.getBadgeByWebhookStatus(e.current_state)),t.xp6(1),t.Oqu(t.lcZ(18,14,e.current_state)),t.xp6(6),t.Q6J("ngIf",e.last_synced>0)("ngIfElse",a),t.xp6(3),t.Q6J("ngIf",e.ch_version)("ngIfElse",a),t.xp6(2),t.Q6J("ngIf",e.drupal_version)("ngIfElse",a)}}let et=(()=>{class n{constructor(e){this.dialog=e}getBadgeByWebhookStatus(e){switch(e.toLowerCase()){case"healthy":return"bg-success";case"suppressed":return"bg-warning";case"unreachable":return"bg-danger";default:return"bg-light"}}openCdfDetailsModal(e){this.dialog.open(F.Ic,{data:{entity:e}})}calculateColumnClass(e){return e%3==0?"col-first":e%3==2?"col-last":""}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(k.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["dxp-dc-ch-connected-sites-card-view"]],inputs:{sitesList:"sitesList"},decls:2,vars:1,consts:[[1,"row","w-100","m-0","mt-3"],["class","col-sm-4 col-md-4",3,"ngClass",4,"ngFor","ngForOf"],[1,"col-sm-4","col-md-4",3,"ngClass"],[1,"card","p-3","w-100"],[1,"card-header"],[1,"card-title","me-auto","mb-0","overflow-hidden"],[1,"dropdown-ellipses",3,"matMenuTriggerFor"],[1,"fe","fe-more-vertical","fe-md"],[1,"content-view-menu"],["menu","matMenu"],["type","button",1,"btn","btn-white","font-weight-normal",3,"click"],["translate",""],[1,"card-body"],[1,"card-text","text-truncate"],["target","_blank",3,"title"],[1,"badge",3,"ngClass"],[1,"card-values"],[1,"last-updated"],[4,"ngIf","ngIfElse"],[1,"versions"],["src","assets/icons/ch_version.png","alt","Content Hub Version"],["src","assets/icons/drupal_version.png","alt","Drupal Version"],["emptyStateContainer",""]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.YNc(1,tt,31,16,"div",1),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngForOf",i.sitesList))},dependencies:[r.mk,r.sg,r.O5,p.Pi,g.VK,g.p6,r.rS,r.uU],styles:["[_nghost-%COMP%]{display:flex}.last-updated[_ngcontent-%COMP%]{color:#52697a;font-size:.75rem}.versions[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.05rem}.card-values[_ngcontent-%COMP%]{display:flex;align-content:space-around;justify-content:space-between;align-items:center;margin-top:1rem}  .content-view-menu{border-radius:6px!important;min-height:inherit!important}  .content-view-menu .mat-menu-content{padding:0!important}.card-header[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{margin:0 .75rem .75rem;padding:0}.card-header-title[_ngcontent-%COMP%]{font-weight:600;font-size:1rem}.col-first[_ngcontent-%COMP%], .col-last[_ngcontent-%COMP%]{padding:0}.col-last[_ngcontent-%COMP%]{padding-left:12px}.col-first[_ngcontent-%COMP%]{padding-right:12px}"],changeDetection:0}),n})();var nt=l(74654),it=l(88300),st=l(72762);function ot(n,s){1&n&&t.GkF(0)}function at(n,s){1&n&&t.GkF(0)}function rt(n,s){1&n&&t.GkF(0)}function lt(n,s){1&n&&t.GkF(0)}const m=function(n,s){return{desc:n,asc:s}};function ct(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",6)(1,"a",16),t.NdJ("click",function(){const a=t.CHM(e).attr,c=t.oxw();return t.KtG(c.sortBy(a))}),t._uU(2),t.qZA(),t.TgZ(3,"dxp-dc-ch-ui-input-filter",17),t.NdJ("filterChange",function(o){const c=t.CHM(e).attr,h=t.oxw();return t.KtG(h.assignFilterValue(c,o))}),t.ALo(4,"translate"),t.qZA()()}if(2&n){const e=s.label,i=s.attr,o=t.oxw();t.xp6(1),t.Q6J("ngClass",t.WLB(6,m,o.isSortedBy(i,"desc"),o.isSortedBy(i,"asc"))),t.xp6(1),t.hij(" [",e,"] "),t.xp6(1),t.Q6J("label",t.lcZ(4,4,e))("value",o.filter.source)}}const dt=function(){return{label:"Source",attr:"source"}},pt=function(){return{label:"ChVersion",attr:"chVersion"}},_t=function(){return{label:"DrupalVersion",attr:"drupalVersion"}},ut=function(){return{label:"WebHook",attr:"webhook"}};let gt=(()=>{class n{constructor(){this.filter={},this.filterChange=new t.vpe,this.sort=new t.vpe,this.ordering={sortedBy:null,order:"asc"},this.status=[],this.statusOptions=[{name:"Healthy",uuid:"healthy"},{name:"Suppressed",uuid:"suppressed"},{name:"Unreachable",uuid:"unreachable"},{name:"Disabled",uuid:"disabled"}],this.ssl=[],this.sslOptions=[{name:"Yes",uuid:"Yes"},{name:"No",uuid:"No"}]}ngOnChanges(e){var i;e&&(null===(i=e.filter)||void 0===i?void 0:i.currentValue)&&this.filterChange.emit(Object.assign({},this.filter)),this.status=this.getStatus()}assignFilterValue(e,i){switch(e){case"startDate":case"endDate":this.filter.lastSync[e]=i?new Date(i):null;break;case"status":this.filter.status=i.map(o=>o.uuid);break;case"validSsl":this.filter.validSsl=i.map(o=>o.uuid);break;default:this.filter[e]=i}this.filterChange.emit(Object.assign({},this.filter))}sortBy(e){this.ordering.order=this.ordering.sortedBy===e&&"asc"===this.ordering.order?"desc":"asc",this.ordering.sortedBy=e,this.sort.emit(this.ordering)}isSortedBy(e,i){return this.ordering.sortedBy!==e?null:this.ordering.order===i?"active":null}getStatus(){return this.filter.status?this.filter.status.map(e=>({name:e,uuid:e})):[]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["dxp-dc-ch-connected-sites-list-header"]],inputs:{filter:"filter"},outputs:{filterChange:"filterChange",sort:"sort"},features:[t.TTD],decls:30,vars:31,consts:[[1,"table-responsive","table-card-header"],[1,"table",2,"table-layout","fixed","word-wrap","break-spaces"],[1,"table-header"],["scope","col",1,"w-15"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["scope","col",1,"w-10"],[1,"d-flex","align-items-end"],["translate","","data-sort","tables-status",1,"text-muted","sort",3,"ngClass","click"],[3,"options","filter","filterChange"],["translate","","data-sort","tables-validssl",1,"text-muted","text-nowrap","sort",3,"ngClass","click"],[3,"isMultiselect","options","filter","filterChange"],["scope","col",1,"w-20"],["translate","","data-sort","tables-lastSyncDate",1,"text-muted","text-nowrap","sort",3,"ngClass","click"],[3,"fromDate","toDate","fromDateChange","toDateChange"],["scope","col",1,"w-5","text-left"],["orderBy",""],["translate","","data-sort","tables-label",1,"text-muted","sort",3,"ngClass","click"],[3,"label","value","filterChange"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"table",1)(2,"thead",2)(3,"tr")(4,"th",3),t.YNc(5,ot,1,0,"ng-container",4),t.qZA(),t.TgZ(6,"th",3),t.YNc(7,at,1,0,"ng-container",4),t.qZA(),t.TgZ(8,"th",3),t.YNc(9,rt,1,0,"ng-container",4),t.qZA(),t.TgZ(10,"th",5)(11,"div",6)(12,"a",7),t.NdJ("click",function(){return i.sortBy("status")}),t._uU(13," [Status] "),t.qZA(),t.TgZ(14,"dxp-dc-ch-ui-dropdown-filter-list",8),t.NdJ("filterChange",function(a){return i.assignFilterValue("status",a)}),t.qZA()()(),t.TgZ(15,"th",5)(16,"div",6)(17,"a",9),t.NdJ("click",function(){return i.sortBy("validSsl")}),t._uU(18," [ValidSSL] "),t.qZA(),t.TgZ(19,"dxp-dc-ch-ui-dropdown-filter-list",10),t.NdJ("filterChange",function(a){return i.assignFilterValue("validSsl",a)}),t.qZA()()(),t.TgZ(20,"th",11),t.YNc(21,lt,1,0,"ng-container",4),t.qZA(),t.TgZ(22,"th",3)(23,"div",6)(24,"a",12),t.NdJ("click",function(){return i.sortBy("lastSyncDate")}),t._uU(25," [LastSync] "),t.qZA(),t.TgZ(26,"dxp-dc-ch-ui-dropdown-daterange-filter",13),t.NdJ("fromDateChange",function(a){return i.assignFilterValue("startDate",a)})("toDateChange",function(a){return i.assignFilterValue("endDate",a)}),t.qZA()()(),t._UZ(27,"th",14),t.qZA()()()(),t.YNc(28,ct,5,9,"ng-template",null,15,t.W1O)),2&e){const o=t.MAs(29);t.xp6(5),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.DdM(18,dt)),t.xp6(2),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.DdM(19,pt)),t.xp6(2),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.DdM(20,_t)),t.xp6(3),t.Q6J("ngClass",t.WLB(21,m,i.isSortedBy("status","desc"),i.isSortedBy("status","asc"))),t.xp6(2),t.Q6J("options",i.statusOptions)("filter",i.status),t.xp6(3),t.Q6J("ngClass",t.WLB(24,m,i.isSortedBy("validSsl","desc"),i.isSortedBy("validSsl","asc"))),t.xp6(2),t.Q6J("isMultiselect",!1)("options",i.sslOptions)("filter",i.ssl),t.xp6(2),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.DdM(27,ut)),t.xp6(3),t.Q6J("ngClass",t.WLB(28,m,i.isSortedBy("lastSyncDate","desc"),i.isSortedBy("lastSyncDate","asc"))),t.xp6(2),t.Q6J("fromDate",i.filter.lastSync.startDate)("toDate",i.filter.lastSync.endDate)}},dependencies:[r.mk,r.tP,p.Pi,nt.V,it.f,st.w,p.X$],styles:["[_nghost-%COMP%]{display:block}.table-header[_ngcontent-%COMP%]{height:2.5rem}.table-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:bottom;border-bottom:none}  .table thead th:first-child .fe{font-size:1rem;margin:0}[_nghost-%COMP%]     tr{text-transform:uppercase}[_nghost-%COMP%]     tr label{text-transform:none}[_nghost-%COMP%]     .table-responsive{overflow:revert}@media screen and (max-height: 785px){[_nghost-%COMP%]     dxp-dc-ch-ui-dropdown-daterange-filter .dropdown-menu.show{height:calc(100vh - 280px);overflow-y:scroll}}[_nghost-%COMP%]     dxp-dc-ch-ui-dropdown-filter-list .dropdown-item{padding:.5rem}"]}),n})();function ht(n,s){if(1&n&&(t.TgZ(0,"span",7),t._uU(1),t.ALo(2,"lowercase"),t.ALo(3,"translate"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.AsE("",t.lcZ(2,2,t.lcZ(3,4,"[Source]")),' = "',e.filter.source,'"')}}function mt(n,s){if(1&n&&(t.TgZ(0,"span",7),t._uU(1),t.ALo(2,"lowercase"),t.ALo(3,"translate"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.AsE("",t.lcZ(2,2,t.lcZ(3,4,"[DrupalVersion]")),' = "',e.filter.drupalVersion,'"')}}function ft(n,s){if(1&n&&(t.TgZ(0,"span",7),t._uU(1),t.ALo(2,"lowercase"),t.ALo(3,"translate"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.AsE("",t.lcZ(2,2,t.lcZ(3,4,"[ChVersion]")),' = "',e.filter.chVersion,'"')}}function Ct(n,s){if(1&n&&(t.TgZ(0,"span",7),t._uU(1),t.ALo(2,"lowercase"),t.ALo(3,"translate"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.AsE("",t.lcZ(2,2,t.lcZ(3,4,"[ValidSSL]")),' = "',e.filter.validSsl,'"')}}function xt(n,s){if(1&n&&(t.TgZ(0,"span",7),t._uU(1),t.ALo(2,"lowercase"),t.ALo(3,"translate"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.AsE("",t.lcZ(2,2,t.lcZ(3,4,"[WebHook]")),' = "',e.filter.webhook,'"')}}function vt(n,s){if(1&n&&(t.TgZ(0,"span",7),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Oqu(e.getFormattedStatus())}}function wt(n,s){if(1&n&&(t.TgZ(0,"span",7),t.ynx(1),t._uU(2),t.ALo(3,"lowercase"),t.ALo(4,"translate"),t.BQk(),t.qZA()),2&n){const e=t.oxw(2);t.xp6(2),t.AsE("",t.lcZ(3,2,t.lcZ(4,4,"[LastSync]"))," ",e.getFormattedDate(),"")}}function bt(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",1)(1,"span",2),t._UZ(2,"img",3),t.qZA(),t.TgZ(3,"div",4),t.YNc(4,ht,4,6,"span",5),t.YNc(5,mt,4,6,"span",5),t.YNc(6,ft,4,6,"span",5),t.YNc(7,Ct,4,6,"span",5),t.YNc(8,xt,4,6,"span",5),t.YNc(9,vt,2,1,"span",5),t.YNc(10,wt,5,6,"span",5),t.TgZ(11,"button",6),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.clear())}),t._uU(12,"Clear all filters"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",0!==e.filter.source.length),t.xp6(1),t.Q6J("ngIf",0!==e.filter.drupalVersion.length),t.xp6(1),t.Q6J("ngIf",0!==e.filter.chVersion.length),t.xp6(1),t.Q6J("ngIf",0!==e.filter.validSsl.length),t.xp6(1),t.Q6J("ngIf",0!==e.filter.webhook.length),t.xp6(1),t.Q6J("ngIf",0!==e.filter.status.length),t.xp6(1),t.Q6J("ngIf",e.filter.lastSync.startDate||e.filter.lastSync.endDate),t.xp6(1),t.Q6J("borderless",!0)}}let St=(()=>{class n{constructor(e,i){this.locale=e,this.translate=i,this.clearAll=new t.vpe}clear(){this.clearAll.emit()}isFilterPresent(){var e,i;return 0!==this.filter.chVersion.length||0!==this.filter.drupalVersion.length||0!==this.filter.status.length||0!==this.filter.source.length||0!==this.filter.validSsl.length||0!==this.filter.webhook.length||null!==(null===(e=this.filter.lastSync)||void 0===e?void 0:e.startDate)||null!==(null===(i=this.filter.lastSync)||void 0===i?void 0:i.endDate)}getFormattedStatus(){const e=this.translate.instant("[Status]").toLowerCase();return 1===this.filter.status.length?`${e} = "${this.filter.status[0]}"`:this.filter.status.map(o=>`${e} = "${o}"`).join(" OR ")}getFormattedDate(){const e=this.filter.lastSync.startDate,i=this.filter.lastSync.endDate;return e&&i?`= ${(0,r.p6)(e,"mediumDate",this.locale)} - ${(0,r.p6)(i,"mediumDate",this.locale)}`:e&&!i?`>= ${(0,r.p6)(e,"mediumDate",this.locale)}`:!e&&i?`<= ${(0,r.p6)(i,"mediumDate",this.locale)}`:"N/A"}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.soG),t.Y36(p.sK))},n.\u0275cmp=t.Xpm({type:n,selectors:[["dxp-dc-ch-connected-sites-select-filter"]],inputs:{filter:"filter"},outputs:{clearAll:"clearAll"},decls:1,vars:1,consts:[["class","filter d-flex flex-grow justify-content-between",4,"ngIf"],[1,"filter","d-flex","flex-grow","justify-content-between"],[1,"m-3","text-md"],["src","assets/icons/filled-filter.svg",1,"filled-filter"],[1,"flex-grow-1","m-2"],["class","filter__option",4,"ngIf"],["dxpTextButton","",1,"fw-normal","clear-all",3,"borderless","click"],[1,"filter__option"]],template:function(e,i){1&e&&t.YNc(0,bt,13,8,"div",0),2&e&&t.Q6J("ngIf",i.isFilterPresent())},dependencies:[r.O5,u.r0,r.i8,p.X$],styles:["[_nghost-%COMP%]{display:block}.filter[_ngcontent-%COMP%]{border:none;border-bottom:1px solid #e0e6eb;border-bottom-left-radius:0;border-bottom-right-radius:0;padding:6px 12px;height:auto}.filter__option[_ngcontent-%COMP%]{display:inline-block;width:auto;background:#D3ECF8;border-radius:14.5px;align-items:center;padding:6px 12px;margin:3px}"]}),n})();function Tt(n,s){if(1&n&&(t.ynx(0),t._UZ(1,"dxp-dc-ch-connected-sites-card-view",14),t.BQk()),2&n){const e=t.oxw(2).ngIf,i=t.oxw(3);t.xp6(1),t.Q6J("sitesList",i.getFilteredList(e))}}function Zt(n,s){if(1&n&&(t.ynx(0),t._UZ(1,"dxp-dc-ch-connected-sites-table-view",14),t.BQk()),2&n){const e=t.oxw(2).ngIf,i=t.oxw(3);t.xp6(1),t.Q6J("sitesList",i.getFilteredList(e))}}function yt(n,s){if(1&n&&(t.ynx(0)(1,11),t.YNc(2,Tt,2,1,"ng-container",12),t.YNc(3,Zt,2,1,"ng-container",13),t.BQk()()),2&n){const e=t.oxw(3).ngIf;t.xp6(1),t.Q6J("ngSwitch",e.viewMode),t.xp6(1),t.Q6J("ngSwitchCase","card")}}function At(n,s){1&n&&(t.TgZ(0,"div",15)(1,"div",16)(2,"div",17)(3,"div",18)(4,"h2",19),t._uU(5," [ConnectedSitesEmpty] "),t.qZA()()()()())}function Lt(n,s){if(1&n&&(t.ynx(0),t.YNc(1,yt,4,2,"ng-container",9),t.YNc(2,At,6,0,"ng-template",null,10,t.W1O),t.BQk()),2&n){const e=s.ngIf,i=t.MAs(3);t.xp6(1),t.Q6J("ngIf",e.length>0)("ngIfElse",i)}}function Mt(n,s){if(1&n&&t.YNc(0,Lt,4,2,"ng-container",0),2&n){const e=t.oxw().ngIf;t.Q6J("ngIf",e.sitesList)}}function Ot(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"dxp-page")(1,"dxp-page-title")(2,"div",1),t._uU(3,"[ConnectedSites]"),t.qZA()(),t.TgZ(4,"dxp-page-actions")(5,"div",2)(6,"dxp-dc-ch-ui-instant-search",3),t.NdJ("valueChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSearchUpdate(o))}),t.ALo(7,"async"),t.qZA(),t.TgZ(8,"dxp-dc-ch-ui-view-mode-switcher",3),t.NdJ("valueChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onViewModeUpdate(o))}),t.qZA()()(),t.TgZ(9,"dxp-page-content")(10,"div")(11,"div",4)(12,"dxp-dc-ch-connected-sites-select-filter",5),t.NdJ("clearAll",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.clear())}),t.qZA(),t.TgZ(13,"dxp-dc-ch-connected-sites-list-header",6),t.NdJ("sort",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.sort(o))})("filterChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onFilterChange(o))}),t.qZA()(),t.TgZ(14,"dxp-web-ui-state-container",7),t.YNc(15,Mt,1,1,"ng-template",null,8,t.W1O),t.qZA()()()()}if(2&n){const e=s.ngIf,i=t.MAs(16),o=t.oxw();t.xp6(6),t.Q6J("value",t.lcZ(7,8,o.search$)),t.xp6(2),t.Q6J("value",e.viewMode),t.xp6(3),t.Q6J("ngClass",e.viewMode+"-view"),t.xp6(1),t.Q6J("filter",o.filter),t.xp6(1),t.Q6J("filter",o.filter),t.xp6(1),t.Q6J("height","400px")("state",e.status)("resolved",i)}}const Dt=function(n,s,e){return{status:n,sitesList:s,viewMode:e}};let Ft=(()=>{class n{constructor(e,i,o,a){this.clientEntityService=e,this.webhookStatusService=i,this.route=o,this.router=a,this.filter=this.getEmptyFilter()}ngOnInit(){this.status$=(0,J.aj)([this.clientEntityService.status$,this.webhookStatusService.status$]).pipe((0,_.U)(([e,i])=>({connected:e,webhooks:i}))),this.search$=this.route.queryParams.pipe((0,_.U)(e=>e.search)),this.viewMode$=this.route.queryParams.pipe((0,_.U)(e=>{var i;return null!==(i=e.view_mode)&&void 0!==i?i:"list"})),this.sitesList$=(0,J.aj)([this.clientEntityService.getClientEntities$(),this.webhookStatusService.get(),this.search$]).pipe((0,_.U)(([e,i,o])=>e.map(a=>{var c,h,C,x,v,w,b,S,T,Z,y,A,L,M;return{client:Object.assign({},a),client_name:a.metadata.settings.name,client_uuid:a.uuid,ch_version:null===(x=null===(C=null===(h=null===(c=a.attributes)||void 0===c?void 0:c.ch_version)||void 0===h?void 0:h.value)||void 0===C?void 0:C.und)||void 0===x?void 0:x.current,drupal_version:null===(S=null===(b=null===(w=null===(v=a.attributes)||void 0===v?void 0:v.drupal_version)||void 0===w?void 0:w.value)||void 0===b?void 0:b.und)||void 0===S?void 0:S.current,valid_ssl:(null===(Z=null===(T=a.attributes)||void 0===T?void 0:T.valid_ssl)||void 0===Z?void 0:Z.und)&&!0===(null===(A=null===(y=a.attributes)||void 0===y?void 0:y.valid_ssl)||void 0===A?void 0:A.und)?"Yes":"No",webhook_url:a.metadata.settings.webhook.url,last_synced:this.getLastSyncDate(a),webhook_uuid:a.metadata.settings.webhook.uuid,current_state:null!==(M=null===(L=null==i?void 0:i.find(Qt=>Qt.uuid===a.metadata.settings.webhook.uuid))||void 0===L?void 0:L.current_state)&&void 0!==M?M:"disabled"}}).filter(a=>Object.keys(a).some(c=>!o||`${a[c]}`.indexOf(o)>=0))))}trackBySiteId(e,i){return i.webhook_uuid}onSearchUpdate(e){this.router.navigate(["./"],{queryParams:{search:e||null},relativeTo:this.route,queryParamsHandling:"merge"})}onViewModeUpdate(e){this.router.navigate(["./"],{queryParams:{view_mode:e||"list"},relativeTo:this.route,queryParamsHandling:"merge"})}clear(){this.filter=this.getEmptyFilter()}onFilterChange(e){this.filter=e}getFilteredList(e){let i=e;return""!==this.filter.source&&(i=d.B9.source(i,this.filter.source)),0!==this.filter.status.length&&(i=d.B9.status(i,this.filter.status)),0!==this.filter.validSsl.length&&(i=d.B9.validSsl(i,this.filter.validSsl)),""!==this.filter.chVersion&&(i=d.B9.chVersion(i,this.filter.chVersion)),""!==this.filter.drupalVersion&&(i=d.B9.drupalVersion(i,this.filter.drupalVersion)),""!==this.filter.webhook&&(i=d.B9.webhook(i,this.filter.webhook)),(this.filter.lastSync.startDate||this.filter.lastSync.endDate)&&(i=d.B9.lastSyncDate(i,this.filter.lastSync.startDate,this.filter.lastSync.endDate)),i}getEmptyFilter(){return{source:"",chVersion:"",drupalVersion:"",status:[],validSsl:[],webhook:"",lastSync:{startDate:null,endDate:null}}}getLastSyncDate(e){var i;const o=null===(i=e.metadata)||void 0===i?void 0:i.metrics;if(!o)return 0;const a=o.publisher?o.publisher.last_updated:o.subscriber.last_updated;return"number"==typeof a&&a>0?1e3*a:0}sort(e){this.sitesList$=this.sitesList$.pipe((0,_.U)(i=>d.Ln[e.sortedBy](i,e.order)))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(D.bY),t.Y36(d.ZK),t.Y36(f.gz),t.Y36(f.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["dxp-dc-ch-connected-sites-list"]],decls:4,vars:11,consts:[[4,"ngIf"],["translate","",1,"font-weight-normal","font-size-lg"],[1,"h-100","d-flex","align-items-end","d-flex","align-items-center","justify-content-between"],[3,"value","valueChange"],[1,"card","filter-header",3,"ngClass"],[3,"filter","clearAll"],[3,"filter","sort","filterChange"],[1,"pt-0",3,"height","state","resolved"],["resolved",""],[4,"ngIf","ngIfElse"],["emptyStateContainer",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"sitesList"],[1,"empty"],[1,"card-body","text-center"],[1,"row","justify-content-center"],[1,"col-12","col-md-10","col-xl-8"],["translate",""]],template:function(e,i){1&e&&(t.YNc(0,Ot,17,10,"dxp-page",0),t.ALo(1,"async"),t.ALo(2,"async"),t.ALo(3,"async")),2&e&&t.Q6J("ngIf",t.kEZ(7,Dt,t.lcZ(1,1,i.status$),t.lcZ(2,3,i.sitesList$),t.lcZ(3,5,i.viewMode$)))},dependencies:[r.mk,r.O5,r.RF,r.n9,r.ED,p.Pi,N.i,U.F,u.yP,u.YT,u.TM,u.II,B.q,W,et,gt,St,r.Ov],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .ads-page-content[_ngcontent-%COMP%]{height:100vh}[_nghost-%COMP%]     .ads-page-header{display:block}[_nghost-%COMP%]     .ads-page-header .ads-page-title{margin-bottom:.75rem}[_nghost-%COMP%]   .filter-header.card[_ngcontent-%COMP%]{margin-bottom:0}[_nghost-%COMP%]   .card.list-view[_ngcontent-%COMP%]{border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom:1px solid #e0e6eb}dxp-dc-ch-connected-sites-list-header[_ngcontent-%COMP%]{padding:0 1.125rem}dxp-dc-ch-connected-sites-list-header[_ngcontent-%COMP%]     thead{border:unset!important}dxp-dc-ch-connected-sites-list-header[_ngcontent-%COMP%]     thead th{border:unset}dxp-dc-ch-connected-sites-table-view[_ngcontent-%COMP%]     tbody td{border:unset!important}"],changeDetection:0}),n})();const kt=[{path:"",canActivate:[l(90592).Gh],component:Ft}];let Pt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[r.ez,f.Bz.forChild(kt),P.UX,p.aw.forChild(),V,d.NN,F.N8,D.iQ,Q.xx,k.Is,g.Tx]}),n})()}}]);